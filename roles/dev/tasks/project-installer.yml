---

- include_vars: project-installer.yml

- name: create root folder
  file:
    path: "{{ root_path }}"
    state: directory

- name: customize root folder
  command: "gvfs-set-attribute {{ root_path }} metadata::custom-icon-name network"

- name: install projects
  command: "ansible-pull -U {{ installer_source }} -e \"git_repository={{ item }} git_destination={{ root_path }}/{{ item | basename | regex_replace('.git$', '')Â }}\" -d {{ installer_destination }}"
  with_items: "{{ repositories }}"

- name: check ubuntu-installer pull
  stat:
    path: "{{ link_destination }}"
  register: link_source_stat

- name: delete ubuntu-installer pull if directory
  file:
    path: "{{ link_destination }}"
    state: absent
  when: link_source_stat.stat.exists and link_source_stat.stat.isdir

- name: link ubuntu-installer pull
  file:
    src: "{{ link_source }}"
    dest: "{{ link_destination }}"
    state: link
